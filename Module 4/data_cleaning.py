# Gene Standardization Map
gene_mapping = {
    "folA, Dfr": "dfrA",
    "dfrA7": "dfrA",
    "dfrA10": "dfrA",
    "inhA, fabI": "fabI",
    "MdtM": "mdtM",
    "MarA": "marA",
    "MurA": "murA",
    "Tet(B)": "tetB",
    "tetA": "tetA",
    "tetD": "tetD",
    "tetR": "tetR",
    "AcrAB-TolC": "acrAB-tolC",
    "AcrEF-TolC": "acrEF-tolC",
    "AcrAD-TolC": "acrAD-tolC",
    "EmrAB-TolC": "emrAB-tolC",
    "MdtABC-TolC": "mdtABC-tolC",
    "MacA": "macA",
    "MacB": "macB",
    "UhpT": "uhpT",
    "APH(3'')-Ib": "aph(3'')-Ib",
    "OxyR": "oxyR",
    "acrE": "acrE",
    "parE": "parE",
    "CTX-M-15": "ctxM-15",
    "sdiA": "sdiA",
    "CRP": "crp",
    "Alr": "alr",
    "QacE": "qacE",
    "H-NS": "hns",
    "S12p": "rpsL",
    "Ddl": "ddl",
    "mdfA": "mdfA",
    "SugE": "sugE",
    "cpxR": "cpxR",
    "dfrA7": "dfrA7",
    "murA": "murA",
    "acrR": "acrR",
    "GlpT": "glpT",
    "acrF": "acrF",
    "AcrZ": "acrZ",
    "marR": "marR",
    "acrB": "acrB",
    "mdtD": "mdtD",
    "folP": "folP",
    "mdsC": "mdsC",
    "APH(3'')-I": "aph(3'')-I",
    "EF-G": "fusA",
    "cpxA": "cpxA",
    "BcrC": "bcrC",
    "dxr": "dxr",
    "Iso-tRNA": "ileS",
    "sul1": "sul1",
    "GdpD": "gdpD",
    "marA": "marA",
    "QnrB family": "qnrB",
    "MdtL": "mdtL",
    "mfd": "mfd",
    "kdpE": "kdpE",
    "PmrF": "pmrF",
    "gyrB": "gyrB",
    "mdtA": "mdtA",
    "PgsA": "pgsA",
    "kasA": "kasA",
    "PhoP": "phoP",
    "mdtM": "mdtM",
    "ramR": "ramR",
    "TEM family": "tem",
    "emrB": "emrB",
    "mdtB": "mdtB",
    "gyrA": "gyrA",
    "patA": "patA",
    "adiY": "adiY",
    "parC": "parC",
    "emrR": "emrR",
    "TolC/OpmH": "tolC",
    "S10p": "rpsJ",
    "emrA": "emrA",
    "YojI": "yojI",
    "leuO": "leuO",
    "CTX-M family": "ctxM",
    "mdtG": "mdtG",
    "mdtK": "mdtK",
    "MarB": "marB",
    "acrD": "acrD",
    "MdtABC-TolC": "mdtABC-tolC",
    "PmrC": "pmrC",
    "rho": "rho",
    "catI": "catI",
    "AAC(6')-Iy": "aac(6')-Iy",
    "gidB": "gidB",
    "APH(6)-Id": "aph(6)-Id",
    "PmrE": "pmrE",
    "AAC(6')-Ic,f,g,h,j,k,l,r-z": "aac(6')-Ic",
    "rpoC": "rpoC",
    "baeS": "baeS",
    "MdfA/Cmr": "mdfA",
    "QnrS1": "qnrS1",
    "acrA": "acrA",
    "ramA": "ramA",
    "APH(6)-Ic/APH(6)-Id": "aph(6)-Ic",
    "sul2": "sul2",
    "mdtH": "mdtH",
    "TEM-1": "tem-1",
    "KatG": "katG",
    "rpoB": "rpoB",
    "mgrB": "mgrB",
    "PmrB": "pmrB",
    "arnA": "arnA",
    "mdtC": "mdtC",
    "baeR": "baeR",
    "nfsA": "nfsA",
    "OprM/OprM family": "oprM",
    "cysB": "cysB",
    "soxS": "soxS",
    "bacA": "bacA",
    "soxR": "soxR",
    "msbA": "msbA",
    "alaS": "alaS",
    "tetD": "tetD",
    "tetA": "tetA",
    "tetR": "tetR",
    "SHV family": "shv",
    "SHV-64": "shv-64",
    "ompF": "ompF",
    "EF-Tu": "tufA"
}

# Product Standardization Map
product_mapping = {
    "Hexose phosphate transport protein UhpT": "UhpT transport protein",
    "Aminoglycoside 3''-phosphotransferase (EC 2.7.1.87) => APH(3'')-I": "APH(3'')-I phosphotransferase",
    "Hydrogen peroxide-inducible genes activator => OxyR": "OxyR activator",
    "Translation elongation factor Tu": "Elongation factor Tu",
    "Multidrug efflux system AcrEF-TolC, membrane fusion component AcrE": "AcrE efflux pump component",
    "DNA topoisomerase IV subunit B (EC 5.99.1.3)": "DNA topoisomerase IV subunit B",
    "Class A beta-lactamase (EC 3.5.2.6) => CTX-M family, extended-spectrum": "CTX-M beta-lactamase",
    "N-(3-oxohexanoyl)-L-homoserine lactone-binding transcriptional activator @ N-(3-oxooctanoyl)-L-homoserine lactone-binding transcriptional activator": "SdiA transcriptional activator",
    "Cyclic AMP receptor protein": "CRP",
    "Alanine racemase (EC 5.1.1.1)": "Alanine racemase",
    "Small multidrug resistance (SMR) efflux transporter => QacE delta 1, quaternary ammonium compounds": "QacE delta 1 efflux transporter",
    "Dihydrofolate reductase (EC 1.5.1.3)": "Dihydrofolate reductase",
    "DNA-binding protein H-NS": "H-NS protein",
    "SSU ribosomal protein S12p (S23e)": "Ribosomal protein S12",
    "D-alanine--D-alanine ligase (EC 6.3.2.4)": "D-Ala-D-Ala ligase",
    "Multidrug efflux pump MdfA/Cmr (of MFS type), broad spectrum": "MdfA efflux pump",
    "Small multidrug resistance (SMR) efflux transporter => SugE, quaternary ammonium compounds": "SugE efflux transporter",
    "Chloramphenicol O-acetyltransferase (EC 2.3.1.28) => CatA1/CatA4 family": "Chloramphenicol acetyltransferase",
    "Enoyl-[acyl-carrier-protein] reductase [NADH] (EC 1.3.1.9)": "FabI reductase",
    "Multidrug efflux pump MdtM (of MFS type)": "MdtM efflux pump",
    "Copper-sensing two-component system response regulator CpxR": "CpxR response regulator",
    "Aminoglycoside 3''-nucleotidyltransferase (EC 2.7.7.-) => ANT(3'')-Ia (AadA family)": "ANT(3'')-Ia nucleotidyltransferase",
    "Aminoglycoside 6-phosphotransferase (EC 2.7.1.72) => APH(6)-Ic/APH(6)-Id": "APH(6)-Id phosphotransferase",
    "Subclass B3 beta-lactamase (EC 3.5.2.6)": "Class B3 beta-lactamase",
    "UDP-N-acetylglucosamine 1-carboxyvinyltransferase (EC 2.5.1.7)": "MurA transferase",
    "Transcriptional regulator of acrAB operon, AcrR": "AcrR regulator",
    "Glycerol-3-phosphate transporter": "GlpT transporter",
    "Aminoglycoside 3''-nucleotidyltransferase (EC 2.7.7.-) => ANT(3'')-Ia (AadA family) @ Aminoglycoside 9-nucleotidyltransferase (EC 2.7.7.-) => ANT(9)-I": "Aminoglycoside nucleotidyltransferase",
    "Multidrug efflux system AcrAB-TolC, membrane fusion component AcrA": "AcrA efflux pump component",
    "Multidrug efflux system AcrEF-TolC, inner-membrane proton/drug antiporter AcrF (RND type)": "AcrF efflux pump component",
    "AcrZ membrane protein associated with AcrAB-TolC multidrug efflux pump": "AcrZ efflux pump component",
    "Multiple antibiotic resistance protein MarR": "MarR regulator",
    "Multidrug efflux system AcrAB-TolC, inner-membrane proton/drug antiporter AcrB (RND type)": "AcrB efflux pump component",
    "Uncharacterized transporter MdtD of major facilitator superfamily (MFS)": "MdtD efflux transporter",
    "Dihydropteroate synthase (EC 2.5.1.15)": "Dihydropteroate synthase",
    "Multidrug efflux system, outer membrane factor lipoprotein of OprM/OprM family": "OprM efflux pump component",
    "Translation elongation factor G": "Elongation factor G",
    "Dihydropteroate synthase type-2 (EC 2.5.1.15) @ Sulfonamide resistance protein": "Sul1/Sul2 resistance protein",
    "Copper sensory histidine kinase CpxA": "CpxA histidine kinase",
    "Undecaprenyl-diphosphatase BcrC (EC 3.6.1.27), conveys bacitracin resistance": "BcrC diphosphatase",
    "1-deoxy-D-xylulose 5-phosphate reductoisomerase (EC 1.1.1.267)": "Dxr reductoisomerase",
    "Isoleucyl-tRNA synthetase (EC 6.1.1.5)": "Isoleucyl-tRNA synthetase",
    "Glycerophosphoryl diester phosphodiesterase (EC 3.1.4.46)": "GdpD phosphodiesterase",
    "Multiple antibiotic resistance protein MarA": "MarA regulator",
    "Pentapeptide repeat protein QnrB family": "QnrB resistance protein",
    "Multidrug efflux pump MdtL (of MFS type)": "MdtL efflux pump",
    "Transcription-repair coupling factor": "Mfd transcription-repair factor",
    "DNA-binding response regulator KdpE": "KdpE response regulator",
    "Class A beta-lactamase (EC 3.5.2.6) => TEM family": "TEM beta-lactamase",
    "Undecaprenyl-phosphate 4-deoxy-4-formamido-L-arabinose transferase (EC 2.4.2.53)": "PmrF transferase",
    "DNA gyrase subunit B (EC 5.99.1.3)": "DNA gyrase subunit B",
    "Multidrug efflux system MdtABC-TolC, membrane fusion component MdtA": "MdtA efflux pump component",
    "CDP-diacylglycerol--glycerol-3-phosphate 3-phosphatidyltransferase (EC 2.7.8.5)": "PgsA phosphatidyltransferase",
    "3-oxoacyl-[acyl-carrier-protein] synthase, KASII (EC 2.3.1.179)": "KasA synthase",
    "Transcriptional regulatory protein PhoP": "PhoP regulator",
    "Transcriptional regulator, AcrR family": "AcrR family regulator",
    "Multidrug efflux system EmrAB-OMF, inner-membrane proton/drug antiporter EmrB (MFS type)": "EmrB efflux pump component",
    "Multidrug efflux system MdtABC-TolC, inner-membrane proton/drug antiporter MdtB (RND type)": "MdtB efflux pump component",
    "DNA gyrase subunit A (EC 5.99.1.3)": "DNA gyrase subunit A",
    "Putrescine aminotransferase (EC 2.6.1.82)": "PatA aminotransferase",
    "Transcriptional regulator of catabolic arginine decarboxylase (adiA)": "AdiY regulator",
    "DNA topoisomerase IV subunit A (EC 5.99.1.3)": "DNA topoisomerase IV subunit A",
    "Multidrug resistance regulator EmrR (MprA)": "EmrR regulator",
    "Outer membrane channel TolC (OpmH)": "TolC outer membrane channel",
    "SSU ribosomal protein S10p (S20e)": "Ribosomal protein S10",
    "Multidrug efflux system EmrAB-OMF, membrane fusion component EmrA": "EmrA efflux pump component",
    "ABC-type siderophore export system, fused ATPase and permease components": "YojI siderophore exporter",
    "LysR family transcriptional activator LeuO": "LeuO activator",
    "Multidrug resistance protein MdtG": "MdtG efflux pump",
    "Uncharacterized transporter YeeO": "YeeO transporter",
    "Multiple antibiotic resistance protein MarB": "MarB regulator",
    "Aminoglycosides efflux system AcrAD-TolC, inner-membrane proton/drug antiporter AcrD (RND type)": "AcrD efflux pump component",
    "Multidrug efflux system MdtABC-TolC, inner-membrane proton/drug antiporter MdtC (RND type)": "MdtC efflux pump component",
    "Lipid A phosphoethanolamine transferase EptA/PmrC (EC 2.7.8.43)": "PmrC transferase",
    "Transcription termination factor Rho": "Rho termination factor",
    "Aminoglycoside N(6')-acetyltransferase (EC 2.3.1.82) => AAC(6')-Ic,f,g,h,j,k,l,r-z": "AAC(6') acetyltransferase",
    "16S rRNA (guanine(527)-N(7))-methyltransferase (EC 2.1.1.170)": "GidB methyltransferase",
    "UDP-glucose 6-dehydrogenase (EC 1.1.1.22)": "PmrE dehydrogenase",
    "DNA-directed RNA polymerase beta' subunit (EC 2.7.7.6)": "RNA polymerase beta' subunit",
    "Sensory histidine kinase BaeS": "BaeS histidine kinase",
    "Transcriptional activator RamA": "RamA activator",
    "Multidrug resistance protein MdtH": "MdtH efflux pump",
    "Catalase-peroxidase KatG (EC 1.11.1.21)": "KatG catalase-peroxidase",
    "DNA-directed RNA polymerase beta subunit (EC 2.7.7.6)": "RNA polymerase beta subunit",
    "PhoP/PhoQ regulator MgrB": "MgrB regulator",
    "Sensor protein BasS/PmrB (activates BasR/PmrA)": "PmrB sensor kinase",
    "Macrolide-specific efflux protein MacA": "MacA efflux protein",
    "UDP-4-amino-4-deoxy-L-arabinose formyltransferase (EC 2.1.2.13) / UDP-glucuronic acid oxidase (UDP-4-keto-hexauronic acid decarboxylating) (EC 1.1.1.305)": "ArnA transferase",
    "Response regulator BaeR": "BaeR response regulator",
    "Oxygen-insensitive NADPH nitroreductase (EC 1.-.-.-)": "NfsA nitroreductase",
    "Cys regulon transcriptional activator CysB": "CysB activator",
    "DNA-binding transcriptional dual regulator SoxS": "SoxS regulator",
    "Undecaprenyl-diphosphatase (EC 3.6.1.27)": "BacA diphosphatase",
    "Redox-sensitive transcriptional activator SoxR": "SoxR activator",
    "Macrolide export ATP-binding/permease protein MacB": "MacB efflux protein",
    "Lipid A export permease/ATP-binding protein MsbA": "MsbA export protein",
    "Alanyl-tRNA synthetase (EC 6.1.1.7)": "Alanyl-tRNA synthetase",
    "Right origin-binding protein": "Hypothetical protein",
    "Tetracycline resistance, MFS efflux pump => Tet(B)": "TetB efflux pump",
    "Tetracycline resistance regulatory protein TetR": "TetR regulator",
    "Class A beta-lactamase (EC 3.5.2.6) => SHV family": "SHV beta-lactamase",
    "Outer membrane porin OmpF": "OmpF porin",
    "hypothetical protein": "Hypothetical protein"
}

# Function Standardization Map
function_mapping = {
    "nan": "Unknown",
    "Hydrogen peroxide-inducible genes activator => OxyR": "OxyR activator",
    "Alanine racemase (EC 5.1.1.1)": "Alanine racemase",
    "Small multidrug resistance (SMR) efflux transporter => QacE delta 1, quaternary ammonium compounds": "QacE efflux transporter",
    "Dihydrofolate reductase (EC 1.5.1.3)": "Dihydrofolate reductase",
    "SSU ribosomal protein S12p (S23e)": "Ribosomal protein S12",
    "D-alanine--D-alanine ligase (EC 6.3.2.4)": "D-Ala-D-Ala ligase",
    "Small multidrug resistance (SMR) efflux transporter => SugE, quaternary ammonium compounds": "SugE efflux transporter",
    "MULTISPECIES: type A-1 chloramphenicol O-acetyltransferase": "Chloramphenicol O-acetyltransferase",
    "Enoyl-[acyl-carrier-protein] reductase [NADH] (EC 1.3.1.9)": "FabI reductase",
    "Multidrug efflux pump MdtM (of MFS type)": "MdtM efflux pump",
    "Translation elongation factor Tu": "Elongation factor Tu",
    "MULTISPECIES: aminoglycoside O-phosphotransferase APH(6)-Id": "APH(6)-Id phosphotransferase",
    "Subclass B3 beta-lactamase (EC 3.5.2.6)": "Class B3 beta-lactamase",
    "aminoglycoside nucleotidyltransferase ANT(3'')ANT(9)": "Aminoglycoside nucleotidyltransferase",
    "Multidrug efflux system AcrAB-TolC, membrane fusion component AcrA": "AcrA efflux pump component",
    "AcrZ membrane protein associated with AcrAB-TolC multidrug efflux pump": "AcrZ efflux pump component",
    "Multidrug efflux system AcrEF-TolC, inner-membrane protondrug antiporter AcrF (RND type)": "AcrF efflux pump component",
    "Chloramphenicol O-acetyltransferase (EC 2.3.1.28) => CatA1CatA4 family": "Chloramphenicol acetyltransferase",
    "Transcriptional regulator of acrAB operon, AcrR": "AcrR regulator",
    "Aminoglycoside 3''-phosphotransferase (EC 2.7.1.87) => APH(3'')-I": "APH(3'')-I phosphotransferase",
    "Translation elongation factor G": "Elongation factor G",
    "MULTISPECIES: sulfonamide-resistant dihydropteroate synthase Sul1": "Dihydropteroate synthase Sul1",
    "DNA-binding protein H-NS": "H-NS protein",
    "Undecaprenyl-diphosphatase BcrC (EC 3.6.1.27), conveys bacitracin resistance": "BcrC diphosphatase",
    "1-deoxy-D-xylulose 5-phosphate reductoisomerase (EC 1.1.1.267)": "Dxr reductoisomerase",
    "Isoleucyl-tRNA synthetase (EC 6.1.1.5)": "Isoleucyl-tRNA synthetase",
    "Glycerophosphoryl diester phosphodiesterase (EC 3.1.4.46)": "GdpD phosphodiesterase",
    "Pentapeptide repeat protein QnrB family": "QnrB resistance protein",
    "Multiple antibiotic resistance protein MarA": "MarA regulator",
    "Multidrug efflux pump MdtL (of MFS type)": "MdtL efflux pump",
    "MULTISPECIES: class A broad-spectrum beta-lactamase TEM-1": "TEM-1 beta-lactamase",
    "MULTISPECIES: aminoglycoside O-phosphotransferase APH(3'')-Ib": "APH(3'')-Ib phosphotransferase",
    "Multidrug efflux system AcrAB-TolC, inner-membrane protondrug antiporter AcrB (RND type)": "AcrB efflux pump component",
    "DNA gyrase subunit B (EC 5.99.1.3)": "DNA gyrase subunit B",
    "CDP-diacylglycerol--glycerol-3-phosphate 3-phosphatidyltransferase (EC 2.7.8.5)": "PgsA phosphatidyltransferase",
    "3-oxoacyl-[acyl-carrier-protein] synthase, KASII (EC 2.3.1.179)": "KasA synthase",
    "Multiple antibiotic resistance protein MarR": "MarR regulator",
    "Class A beta-lactamase (EC 3.5.2.6) => TEM family": "TEM beta-lactamase",
    "Multidrug efflux system EmrAB-OMF, inner-membrane protondrug antiporter EmrB (MFS type)": "EmrB efflux pump component",
    "Multidrug efflux system AcrEF-TolC, membrane fusion component AcrE": "AcrE efflux pump component",
    "Dihydropteroate synthase (EC 2.5.1.15)": "Dihydropteroate synthase",
    "UDP-N-acetylglucosamine 1-carboxyvinyltransferase (EC 2.5.1.7)": "MurA transferase",
    "Outer membrane channel TolC (OpmH)": "TolC outer membrane channel",
    "SSU ribosomal protein S10p (S20e)": "Ribosomal protein S10",
    "MULTISPECIES: class A extended-spectrum beta-lactamase CTX-M-15": "CTX-M-15 beta-lactamase",
    "Multidrug efflux system EmrAB-OMF, membrane fusion component EmrA": "EmrA efflux pump component",
    "Class A beta-lactamase (EC 3.5.2.6) => CTX-M family, extended-spectrum": "CTX-M beta-lactamase",
    "Multidrug resistance regulator EmrR (MprA)": "EmrR regulator",
    "MULTISPECIES: trimethoprim-resistant dihydrofolate reductase DfrA7": "DfrA7 dihydrofolate reductase",
    "Multiple antibiotic resistance protein MarB": "MarB regulator",
    "Multidrug efflux system MdtABC-TolC, membrane fusion component MdtA": "MdtA efflux pump component",
    "Multidrug efflux system MdtABC-TolC, inner-membrane protondrug antiporter MdtC (RND type)": "MdtC efflux pump component",
    "Transcription termination factor Rho": "Rho termination factor",
    "MULTISPECIES: quinolone resistance pentapeptide repeat protein QnrS1": "QnrS1 resistance protein",
    "16S rRNA (guanine(527)-N(7))-methyltransferase (EC 2.1.1.170)": "GidB methyltransferase",
    "Aminoglycoside N(6')-acetyltransferase (EC 2.3.1.82) => AAC(6')-Ic,f,g,h,j,k,l,r-z": "AAC(6') acetyltransferase",
    "DNA-directed RNA polymerase beta' subunit (EC 2.7.7.6)": "RNA polymerase beta' subunit",
    "Multidrug efflux system MdtABC-TolC, inner-membrane protondrug antiporter MdtB (RND type)": "MdtB efflux pump component",
    "Multidrug efflux pump MdfACmr (of MFS type), broad spectrum": "MdfA efflux pump",
    "Aminoglycoside 6-phosphotransferase (EC 2.7.1.72) => APH(6)-IcAPH(6)-Id": "APH(6)-Ic/Id phosphotransferase",
    "Catalase-peroxidase KatG (EC 1.11.1.21)": "KatG catalase-peroxidase",
    "MULTISPECIES: quaternary ammonium compound efflux SMR transporter QacE delta 1": "QacE efflux transporter",
    "DNA-directed RNA polymerase beta subunit (EC 2.7.7.6)": "RNA polymerase beta subunit",
    "MULTISPECIES: sulfonamide-resistant dihydropteroate synthase Sul2": "Dihydropteroate synthase Sul2",
    "DNA gyrase subunit A (EC 5.99.1.3)": "DNA gyrase subunit A",
    "Macrolide-specific efflux protein MacA": "MacA efflux protein",
    "Multidrug efflux system, outer membrane factor lipoprotein of OprMOprM family": "OprM efflux pump component",
    "Aminoglycosides efflux system AcrAD-TolC, inner-membrane protondrug antiporter AcrD (RND type)": "AcrD efflux pump component",
    "Macrolide export ATP-bindingpermease protein MacB": "MacB efflux protein",
    "MULTISPECIES: tetracycline efflux MFS transporter Tet(B)": "TetB efflux pump",
    "Tetracycline resistance, MFS efflux pump => Tet(B)": "TetB efflux pump",
    "MULTISPECIES: class A extended-spectrum beta-lactamase SHV-12": "SHV-12 beta-lactamase",
    "Class A beta-lactamase (EC 3.5.2.6) => SHV family": "SHV beta-lactamase",
    "MULTISPECIES: trimethoprim-resistant dihydrofolate reductase DfrA10": "DfrA10 dihydrofolate reductase"
}
# Classification Standardization Map (continued)
classification_mapping = {
    "antibiotic resistant gene variant or mutant,fosfomycin resistance gene": "fosfomycin resistance gene",
    "aminoglycoside resistance gene,antibiotic inactivation enzyme": "aminoglycoside resistance gene",
    "regulator modulating expression of antibiotic resistance genes": "regulator modulating antibiotic resistance",
    "antibiotic resistant gene variant or mutant,elfamycin resistance gene": "elfamycin resistance gene",
    "efflux pump conferring antibiotic resistance": "efflux pump conferring antibiotic resistance",
    "antibiotic resistant gene variant or mutant,fluoroquinolone resistance gene": "fluoroquinolone resistance gene",
    "antibiotic inactivation enzyme,beta-lactam resistance gene": "beta-lactam resistance gene",
    "efflux pump conferring antibiotic resistance,gene modulating antibiotic efflux": "efflux pump conferring antibiotic resistance",
    "antibiotic target in susceptible species": "antibiotic target in susceptible species",
    "0": "unknown",
    "antibiotic target replacement protein,trimethoprim resistance gene": "trimethoprim resistance gene",
    "antibiotic inactivation enzyme": "antibiotic inactivation enzyme",
    "antibiotic resistant gene variant or mutant,efflux pump conferring antibiotic resistance,gene modulating antibiotic efflux": "efflux pump conferring antibiotic resistance",
    "antibiotic resistant gene variant or mutant,sulfonamide resistance gene": "sulfonamide resistance gene",
    "antibiotic target protection protein": "antibiotic target protection protein",
    "antibiotic target replacement protein,sulfonamide resistance gene": "sulfonamide resistance gene",
    "protein altering cell wall charge conferring antibiotic resistance": "cell wall charge modification resistance",
    "efflux pump conferring antibiotic resistance,gene modulating antibiotic efflux,gene modulating permeability to antibiotic": "efflux pump conferring antibiotic resistance",
    "antibiotic resistance gene cluster,cassette,or operon": "antibiotic resistance gene cluster",
    "antibiotic target protection protein,fluoroquinolone resistance gene": "fluoroquinolone resistance gene",
    "aminoglycoside resistance gene": "aminoglycoside resistance gene",
    "gene altering cell wall charge conferring antibiotic resistance,polymyxin resistance gene": "polymyxin resistance gene",
    "antibiotic resistant gene variant or mutant,efflux pump conferring antibiotic resistance,gene altering cell wall charge conferring antibiotic resistance,gene modulating antibiotic efflux,polymyxin resistance gene": "polymyxin resistance gene",
    "gene modulating antibiotic efflux,sulfonamide resistance gene": "sulfonamide resistance gene",
    "antibiotic inactivation enzyme,chloramphenicol resistance gene": "chloramphenicol resistance gene",
    "gene conferring resistance via absence": "gene conferring resistance via absence",
    "antibiotic activation enzyme": "antibiotic activation enzyme",
    "antibiotic resistant gene variant or mutant,rifampin resistance gene": "rifampin resistance gene",
    "efflux pump conferring antibiotic resistance,gene altering cell wall charge conferring antibiotic resistance,gene conferring resistance via absence,gene modulating antibiotic efflux,polymyxin resistance gene": "polymyxin resistance gene",
    "antibiotic resistant gene variant or mutant,nitrofuratoin resistance gene": "nitrofuratoin resistance gene",
    "aminocoumarin resistance gene": "aminocoumarin resistance gene",
    "antibiotic resistant gene variant or mutant,efflux pump conferring antibiotic resistance,gene modulating antibiotic efflux,gene modulating permeability to antibiotic": "efflux pump conferring antibiotic resistance",
    "gene conferring antibiotic resistance via molecular bypass,peptide antibiotic resistance gene": "peptide antibiotic resistance gene",
    "antibiotic resistant gene variant or mutant,beta-lactam resistance gene,gene modulating permeability to antibiotic": "beta-lactam resistance gene"
}

# Source Organism Standardization Map
organism_mapping = {
    "Escherichia coli str. K-12 substr. MC4100": "Escherichia coli",
    "Escherichia coli str. K-12 substr. MG1655": "Escherichia coli",
    "Escherichia coli str. K-12 substr. W3110": "Escherichia coli",
    "Escherichia coli O157:H7 str. Sakai": "Escherichia coli",
    "Escherichia coli ATCC 25922": "Escherichia coli",
    "Escherichia coli": "Escherichia coli",
    "Salmonella enterica subsp. enterica serovar Typhimurium str. LT2": "Salmonella enterica",
    "Salmonella enterica subsp. enterica serovar Typhimurium": "Salmonella enterica",
    "Salmonella enterica subsp. enterica serovar Agona str. SL483": "Salmonella enterica",
    "Salmonella enterica subsp. enterica serovar Enteritidis": "Salmonella enterica",
    "Salmonella enterica subsp. enterica serovar Typhi str. CT18": "Salmonella enterica",
    "Salmonella enterica": "Salmonella enterica",
    "Morganella morganii subsp. morganii KT": "Morganella morganii",
    "Pseudomonas aeruginosa": "Pseudomonas aeruginosa",
    "0": "unknown",
    "Bacteria][Archaea": "Bacteria/Archaea",
    "Acinetobacter baumannii": "Acinetobacter baumannii",
    "Bacteria": "Bacteria",
    "Enterobacter cloacae": "Enterobacter cloacae",
    "Vibrio fluvialis": "Vibrio fluvialis",
    "Klebsiella pneumoniae": "Klebsiella pneumoniae",
    "Gammaproteobacteria": "Gammaproteobacteria",
    "Vibrio cholerae": "Vibrio cholerae",
    "Proteobacteria": "Proteobacteria",
    "Serratia marcescens": "Serratia marcescens"
}

# Evidence Standardization Map
evidence_mapping = {
    "BLAT": "BLAT",
    "K-mer Search": "K-mer Search" 
}

# Property Standardization Map 
property_mapping = {
    "Antibiotic Resistance": "Antibiotic Resistance"
}

# Source Standardization Map
source_mapping = {
    "CARD": "CARD",
    "PATRIC": "PATRIC",
    "NDARO": "NDARO"
}

# General standardization for numerical columns with "0.0" values
numerical_mapping = {
    "0.0": "unknown",
    "0": "unknown"
}

# Identity Mapping
identity_mapping = {key: str(key) for key in [0.0, 80.0, 81.0, 82.0, 85.0, 86.0, 87.0, 88.0, 89.0, 90.0, 
                                              91.0, 92.0, 93.0, 94.0, 95.0, 96.0, 97.0, 98.0, 99.0, 100.0]}
identity_mapping["0.0"] = "unknown"
identity_mapping["0"] = "unknown"

# Complete mapping dictionary that includes all individual mappings
complete_mapping = {
    "Gene": gene_mapping,
    "Product": product_mapping,
    "Function": function_mapping,
    "Classification": classification_mapping,
    "Source Organism": organism_mapping,
    "Evidence": evidence_mapping,
    "Property": property_mapping,
    "Source": source_mapping,
    "Subject Coverage": numerical_mapping,
    "Query Coverage": numerical_mapping,
    "Identity": identity_mapping,
    "E-value": {key: str(key) for key in numerical_mapping}
}

import pandas as pd

def apply_mapping(df, column_name):

    if column_name in complete_mapping:
        mapping = complete_mapping[column_name]
        # Create a copy of the column
        original_values = df[column_name].copy()
        
        # Apply mapping but handle missing keys by keeping original value
        df[column_name] = df[column_name].apply(lambda x: mapping.get(x, x))
        
        # Check for NaN values that might have been introduced
        if df[column_name].isna().any():
            # For any NaN values, restore the original value
            na_mask = df[column_name].isna()
            df.loc[na_mask, column_name] = original_values[na_mask]
            
            # Print warning about values not found in mapping
            missing_values = original_values[na_mask].unique()
            print(f"Warning: {len(missing_values)} values in {column_name} not found in mapping dictionary")
            
    return df

# Complete application:
def clean_data(input_file, output_file):
  
    # Load data
    df = pd.read_csv(input_file)
    print(f"Original data has {len(df)} rows and {len(df.columns)} columns")
    
    # Store original row count
    original_row_count = len(df)
    
    # Apply mappings to each column
    for column_name in df.columns:
        df = apply_mapping(df, column_name)
        # Verify row count hasn't changed
        if len(df) != original_row_count:
            print(f"ERROR: Row count changed after mapping {column_name}!")
            print(f"Original: {original_row_count}, New: {len(df)}")
    
    # Verify final results
    print(f"Cleaned data has {len(df)} rows and {len(df.columns)} columns")
    
    # Save cleaned data
    df.to_csv(output_file, index=False)
    print(f"Saved cleaned data to {output_file}")
    
    return df

# Usage example:
clean_data("C:/Users/Fatima/Downloads/cleaned_data.csv", "cleaned_antimicrobial_resistance_data.csv")

